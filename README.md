## **PySpark Books and Authors**
### Самостоятельное задание №2 — Анализ книг и авторов в PySpark

Есть два набора данных: информация о книгах и информация об авторах. Вам нужно объединить эти данные и провести анализ, чтобы найти различные статистики о книгах и авторах.

### Таблицы данных

#### Таблица `books`

| Столбец        | Описание                                  |
|----------------|-------------------------------------------|
| `book_id`      | ID книги                                  |
| `title`        | Название книги                            |
| `author_id`    | ID автора                                 |
| `genre`        | Жанр книги                                |
| `price`        | Цена книги                                |
| `publish_date` | Дата публикации (формат YYYY-MM-DD)      |

#### Таблица `authors`

| Столбец       | Описание                                  |
|---------------|-------------------------------------------|
| `author_id`   | ID автора                                 |
| `name`        | Имя автора                                |
| `birth_date`  | Дата рождения автора (формат YYYY-MM-DD) |
| `country`     | Страна автора                             |

---

## Инструменты и среда

- Среда выполнения: **Google Colab**
- Используемая технология: **PySpark** для обработки и анализа данных

---

## Шаги выполнения

### 1. Чтение данных
- Данные загружены из CSV-файлов:
  - [books.csv](https://disk.yandex.ru/d/7ObST0hRb5E4qA)
  - [authors.csv](https://disk.yandex.ru/d/jAQHt61PtyxVvg)
- CSV-файлы загружены в DataFrame PySpark.

### 2. Обработка данных
- Столбцы `publish_date` и `birth_date` преобразованы в формат даты.

### 3. Объединение данных
- Таблицы `books` и `authors` объединены по `author_id`.

### 4. Анализ данных
- **Топ-5 авторов по выручке от книг:**

| Автор       | Общая выручка (единиц валюты) |
|------------|-------------------------------|
| Author 1   | XXX.XX                        |
| Author 2   | XXX.XX                        |
| Author 3   | XXX.XX                        |
| Author 4   | XXX.XX                        |
| Author 5   | XXX.XX                        |

- **Количество книг в каждом жанре:**

| Жанр       | Количество книг |
|-----------|----------------|
| Genre 1   | XX             |
| Genre 2   | XX             |
| Genre 3   | XX             |
| …         | …              |

- **Средняя цена книг по каждому автору:**

| Автор       | Средняя цена (единиц валюты) |
|------------|-------------------------------|
| Author 1   | XX.XX                         |
| Author 2   | XX.XX                         |
| …          | …                             |

- **Книги, опубликованные после 2000 года, отсортированные по цене:**

| Название книги | Автор       | Жанр       | Цена  | Дата публикации |
|----------------|------------|-----------|-------|----------------|
| Book 1         | Author 1   | Genre 1  | XX.XX | YYYY-MM-DD     |
| Book 2         | Author 2   | Genre 2  | XX.XX | YYYY-MM-DD     |
| …              | …          | …         | …     | …              |

## Выводы
- Определены авторы с наибольшей выручкой от книг.
- Получено распределение количества книг по жанрам.
- Рассчитана средняя цена книг для каждого автора.
- Выявлены книги, опубликованные после 2000 года, с сортировкой по цене.
